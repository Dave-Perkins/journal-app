{% extends 'journal/base.html' %}
{% load static %}

{% block title %}Login - Equestrian Journal{% endblock %}

{% block content %}
<div style="max-width: 500px; margin: 2rem auto;">
    <!-- Large Logo -->
    <div style="text-align: center; margin-bottom: 2rem;">
        <img src="{% static 'logo.png' %}" alt="inSights logo" style="height: 100px; width: auto; margin-bottom: 1rem;">
        <h1 style="margin: 0; color: #2c3e50; font-size: 2.5rem;">inSights</h1>
        <p style="color: #7f8c8d; font-size: 0.95rem; margin-top: 0.5rem;">Equestrian Journal</p>
    </div>
    
    <h2 style="text-align: center; margin-bottom: 2rem; color: #2c3e50;">Select Your Horse and Name</h2>
    
    <form method="post" style="padding: 2rem;">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="horse">Select Your Horse:</label>
            <select id="horse" name="horse" required onchange="updateRiders()">
                <option value="">-- Choose a horse --</option>
                {% for horse in horses %}
                    <option value="{{ horse.id }}">{{ horse.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="rider">Select Your Name:</label>
            <select id="rider" name="rider" required>
                <option value="">-- Select horse first --</option>
            </select>
        </div>

        <button type="submit" class="btn" style="width: 100%; padding: 0.8rem; font-size: 1.1rem;">Log In</button>
    </form>
</div>

<script>
    function updateRiders() {
        const horseSelect = document.getElementById('horse');
        const riderSelect = document.getElementById('rider');
        const horseId = horseSelect.value;

        if (!horseId) {
            riderSelect.innerHTML = '<option value="">-- Select horse first --</option>';
            return;
        }

        fetch(`/api/riders/${horseId}/`)
            .then(response => response.json())
            .then(data => {
                riderSelect.innerHTML = '<option value="">-- Choose a rider --</option>';
                data.forEach(rider => {
                    const option = document.createElement('option');
                    option.value = rider.id;
                    option.textContent = rider.name;
                    riderSelect.appendChild(option);
                });
            });
    }
</script>
{% endblock %}
