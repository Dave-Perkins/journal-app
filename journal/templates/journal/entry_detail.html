{% extends 'journal/base.html' %}

{% block title %}Entry - Equestrian Journal{% endblock %}

{% block content %}
<div style="margin-bottom: 2rem;">
    <a href="{% url 'dashboard' %}" style="color: #2c3e50; text-decoration: none;">‚Üê Back to Dashboard</a>
</div>

<div class="card">
    <h2>Journal Entry</h2>
    <p class="card-meta">
        <strong>{{ rider.name }}</strong> riding <strong>{{ rider.horse.name }}</strong>
        <br>
        {{ entry.created_at|date:"F j, Y \a\t g:i A" }}
        {% if entry.updated_at != entry.created_at %}
            <br><small>(Updated: {{ entry.updated_at|date:"F j, Y \a\t g:i A" }})</small>
        {% endif %}
    </p>

    {% if entry.text_content %}
        <div style="margin: 1.5rem 0;">
            <h3 style="margin-bottom: 1rem;">Reflection</h3>
            <p style="white-space: pre-wrap; line-height: 1.6;">{{ entry.text_content }}</p>
        </div>
    {% endif %}

    {% if entry.image %}
        <div style="margin: 1.5rem 0;">
            <h3 style="margin-bottom: 1rem;">Photo</h3>
            <img src="{{ entry.image.url }}" alt="Entry photo" class="entry-image">
        </div>
    {% endif %}

    <div class="entry-actions">
        {% if not entry.alerted_michelle %}
            <a href="{% url 'alert_michelle' entry.id %}" class="btn btn-success">Alert Michelle to Review</a>
        {% else %}
            <span style="color: #28a745; padding: 0.6rem 1.2rem; font-weight: 500;">‚úì Michelle has been notified</span>
        {% endif %}
        <a href="{% url 'dashboard' %}" class="btn btn-secondary">Back</a>
    </div>
</div>

{% if comments %}
    <div style="margin-top: 2rem; padding: 1.5rem; background-color: #e3f2fd; border-left: 4px solid #1976d2; border-radius: 4px;">
        <h3 style="color: #0d47a1; margin-bottom: 1rem;">üí¨ Michelle's Feedback</h3>
        {% for comment in comments %}
            <div style="background-color: white; padding: 1rem; margin-bottom: 1rem; border-radius: 4px; border-left: 3px solid #1976d2;">
                <p style="color: #7f8c8d; font-size: 0.9rem; margin-bottom: 0.5rem;">{{ comment.created_at|date:"F j, Y \a\t g:i A" }}</p>
                <p style="white-space: pre-wrap; line-height: 1.6; margin: 0;">{{ comment.text }}</p>
            </div>
        {% endfor %}
    </div>
{% else %}
    {% if entry.alerted_michelle %}
        <div style="margin-top: 2rem; padding: 1.5rem; background-color: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px;">
            <p style="color: #856404; margin: 0;">‚è≥ Waiting for Michelle's feedback...</p>
        </div>
    {% endif %}
{% endif %}
{% endblock %}
